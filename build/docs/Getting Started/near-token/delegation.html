<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Token Delegation | NEARverse Portal</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://near.github.io/wiki/docs/Getting Started/near-token/delegation"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Token Delegation | NEARverse Portal"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/wiki/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://near.github.io/wiki/docs/Getting Started/near-token/delegation"><link data-react-helmet="true" rel="alternate" href="https://near.github.io/wiki/docs/Getting Started/near-token/delegation" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://near.github.io/wiki/docs/Getting Started/near-token/delegation" hreflang="x-default"><link rel="stylesheet" href="/wiki/assets/css/styles.8f84a3c9.css">
<link rel="preload" href="/wiki/assets/js/runtime~main.ce76e5ac.js" as="script">
<link rel="preload" href="/wiki/assets/js/main.29d6ec1b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/wiki/"><div class="navbar__logo"><img src="/wiki/img/logo.svg" alt="NEAR Logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/wiki/img/logo.svg" alt="NEAR Logo" class="themedImage_1VuW themedImage--dark_hz6m"></div><b class="navbar__title">NEARverse Portal</b></a><a class="navbar__item navbar__link navbar__link--active" href="/wiki/docs/intro">Wiki</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/near/wiki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Contribute<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/wiki/docs/intro">Welcome to NEAR!</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Developers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">End Users</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Forum</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Founders</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Getting Started</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/docs/Getting Started/grants-and-funding">Grants &amp; Funding</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/docs/Getting Started/resources">Resources</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">ecosystem-success</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">near-token</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/docs/Getting Started/near-token/README">NEAR Token</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/docs/Getting Started/near-token/lockups">Lockups</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/docs/Getting Started/near-token/token-balance">Token Balance</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/docs/Getting Started/near-token/token-custody">Token Custody</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/wiki/docs/Getting Started/near-token/delegation">Token Delegation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/wiki/docs/Getting Started/near-token/whats-an-nft">What&#x27;s an NFT?</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Governance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Guilds</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Investors</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">News</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Resources</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Technology</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Validators</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Token Delegation</h1></header><h2 class="anchor anchorWithStickyNavbar_31ik" id="overview">Overview<a aria-hidden="true" class="hash-link" href="#overview" title="Direct link to heading">â€‹</a></h2><p>To learn more about what validation and delegation are, please see the <a href="/wiki/docs/validator/validator-overview.md">Validation docs</a> and <a href="/wiki/docs/validator/validator-support/faq.md">validation FAQ</a>. The current page will describe the mechanics of participating in delegation.</p><p>At a high level, anyone can delegate their tokens to a staking pool which is run by a validator. This is usually just called &quot;Staking&quot;. This is possible even if your tokens are in a lockup contract <!-- -->(<!-- -->as most tokens are during the network&#x27;s early release<!-- -->)<!-- -->. Delegating to a staking pool allows you to receive some staking rewards <!-- -->(<!-- -->which will activate as part of the Phase II rollout and depend on the exact fees charged by the validator<!-- -->)<!-- --> and to participate in protocol governance by adding weight to the vote of the validator whose pool you have delegated to.</p><p>You can participate in delegation by using a website <!-- -->(<!-- -->GUI<!-- -->)<!-- -->, using the <code>view</code> and <code>call</code> methods of the command-line interface <!-- -->(<!-- -->CLI<!-- -->)<!-- --> or via sending RPC calls directly. These are described below.</p><p>Reminder: If you haven&#x27;t already, evaluate your token custody options from <a href="/wiki/docs/Getting Started/near-token/token-custody">this documentation page</a>.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="viewing-and-choosing-validators">Viewing and Choosing Validators<a aria-hidden="true" class="hash-link" href="#viewing-and-choosing-validators" title="Direct link to heading">â€‹</a></h3><p>During early days, the staking pool contracts <!-- -->(<a href="https://github.com/near/core-contracts/tree/master/staking-pool" target="_blank" rel="noopener noreferrer">code</a>)<!-- --> allow validators to select what fee they will charge on rewards earned by pools they run. In the future, updated versions of the staking pool contracts may include more parameters <!-- -->(<!-- -->which is one of the nice features enabled by NEAR&#x27;s contract-based delegation<!-- -->)<!-- -->.</p><p>Several community-run lists of validators list who they are, how much stake they have, what their vote was <a href="https://near.org/blog/mainnet-phase-i/" target="_blank" rel="noopener noreferrer">for the Phase II transition</a> and more. These can be helpful for selecting where to delegate your tokens. As always, do your own diligence.</p><table><thead><tr><th align="left">Operator</th><th align="left">URL <!-- -->(<!-- -->to copy and paste<!-- -->)</th></tr></thead><tbody><tr><td align="left">NEAR Explorer</td><td align="left"><a href="https://explorer.near.org/nodes/validators" target="_blank" rel="noopener noreferrer">https://explorer.near.org/nodes/validators</a></td></tr><tr><td align="left">DokiaCapital</td><td align="left"><a href="https://staking.dokia.cloud/staking/near/validators" target="_blank" rel="noopener noreferrer">https://staking.dokia.cloud/staking/near/validators</a></td></tr><tr><td align="left">Stardust NEAR Pool</td><td align="left"><a href="https://near-staking.com/" target="_blank" rel="noopener noreferrer">https://near-staking.com/</a></td></tr><tr><td align="left">YOUR OPERATOR</td><td align="left">ADD YOUR LINK HERE</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_31ik" id="gui-based-delegation-via-a-website-or-app">GUI-based delegation <!-- -->(<!-- -->via a website or app<!-- -->)<a aria-hidden="true" class="hash-link" href="#gui-based-delegation-via-a-website-or-app" title="Direct link to heading">â€‹</a></h2><p>Disclaimer: the list below is community-maintained, and is not an endorsement by NEAR to use any of them. Do your own research before staking your funds with them!</p><table><thead><tr><th align="left">Provider</th><th align="left">URL <!-- -->(<!-- -->to copy and paste<!-- -->)</th><th align="left">Added on</th></tr></thead><tbody><tr><td align="left">NEAR Wallet</td><td align="left"><a href="https://wallet.near.org" target="_blank" rel="noopener noreferrer">https://wallet.near.org</a></td><td align="left">Oct 11 2020</td></tr><tr><td align="left">DokiaCapital</td><td align="left"><a href="https://staking.dokia.cloud" target="_blank" rel="noopener noreferrer">https://staking.dokia.cloud</a></td><td align="left">Sept 11 2020</td></tr><tr><td align="left">Moonlet Wallet</td><td align="left"><a href="https://moonlet.io/near-staking" target="_blank" rel="noopener noreferrer">https://moonlet.io/near-staking</a></td><td align="left">15 Oct 2020</td></tr><tr><td align="left">add here</td><td align="left">your link</td><td align="left">first come, first serve</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_31ik" id="cli-based-delegation">CLI-based delegation<a aria-hidden="true" class="hash-link" href="#cli-based-delegation" title="Direct link to heading">â€‹</a></h2><p>Disclaimer: the documentation below refers to the Github repository <a href="https://github.com/near/core-contracts/" target="_blank" rel="noopener noreferrer">Core Contracts</a>. Always check the source of the smart contract before delegating your funds to it!</p><p>You can use <code>near-cli</code> with NEAR Core Contracts to delegation via:</p><ol><li>Lockup Contract</li><li>Staking Pool</li></ol><p>Before starting, make sure you are running the latest version of <a href="https://github.com/near/near-cli" target="_blank" rel="noopener noreferrer">near-cli</a>, you are familiar with <a href="https://docs.near.org/docs/concepts/gas" target="_blank" rel="noopener noreferrer">gas fees</a> and you are sending transactions to the correct NEAR network. By default <code>near-cli</code> is configured to work with TestNet. You can change the network to MainNet by issuing the command</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">NODE_ENV</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">mainnet</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>It will also be helpful to set some variables, which we will use in commands below. On Linux/macOS/Unix:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export ACCOUNT_ID=#your account id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export LOCKUP_ID=#your lockup contract address</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export POOL_ID=#your staking pool</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If you&#x27;re using Windows, you can replace all the <code>export</code> commands with <code>set</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">set ACCOUNT_ID=#your account id</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You can check that you set these correctly with <code>echo</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">echo $ACCOUNT_ID</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that when you set variables with <code>export</code> you do not prefix them with the dollar sign, but when you use them elsewhere such as with <code>echo</code>, you need the dollar sign.</p><p>If you&#x27;re using a secondary account on a Ledger Nano device, you will also want to create an HD_PATH variable. For example:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export HD_PATH=&quot;account 44&#x27;/397&#x27;/0&#x27;/0&#x27;/2&#x27;&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The default HD path for the NEAR app on Ledger devices is <code>44&#x27;/397&#x27;/0&#x27;/0&#x27;/1&#x27;</code>. See more info on using <code>near-cli</code> with Ledger <a href="/wiki/docs/Getting Started/near-token/token-custody#option-1-ledger-via-cli">here</a>.</p><blockquote><p><strong>Heads up</strong>  </p><p> Signing a transaction with the wrong Ledger key can help associating multiple accounts of a user, since even failed transactions are recorded to the blockchain and can be subsequently analyzed. </p></blockquote><h2 class="anchor anchorWithStickyNavbar_31ik" id="1-lockup-contracts-delegation">1. Lockup Contracts Delegation<a aria-hidden="true" class="hash-link" href="#1-lockup-contracts-delegation" title="Direct link to heading">â€‹</a></h2><p>The <a href="https://github.com/near/core-contracts/tree/master/lockup" target="_blank" rel="noopener noreferrer">Lockup Contract</a> is common among NEAR contributors and, essentially, anyone who didn&#x27;t acquire tokens through an exchange. This contract acts as an escrow that locks and holds an owner&#x27;s tokens for a lockup period <!-- -->(<!-- -->such as vesting<!-- -->)<!-- -->. You can learn more about lockups and their implementation in the <a href="/wiki/docs/Getting Started/near-token/lockups">this documentation page</a>.</p><p>The owner may want to stake these tokens <!-- -->(<!-- -->including locked ones<!-- -->)<!-- --> to help secure the network and also earn staking rewards that are distributed to the validator. The lockup contract doesn&#x27;t allow to directly stake from its account, so the owner delegates the tokens using the contract built-in functions.</p><blockquote><p><strong>heads up</strong>  </p><p> The commands below are tested with <a href="https://github.com/near/core-contracts/tree/877e2db699a02b81fc46f5034642a2ebd06d9f19" target="_blank" rel="noopener noreferrer">build 877e2db</a> of the Core Contracts.</p><p>They also use formatting only available on Linux/macOS/Unix. If you are using Windows, you will need to replace dollar variables, <code>$LOCKUP_ID</code>, with percent variables, <code>%LOCKUP_ID%</code>. And you will need to use all double quotes, so things like <code>&#x27;{&quot;account_id&quot;: &quot;&#x27;$ACCOUNT_ID&#x27;&quot;}&#x27;</code> become <code>&quot;{\&quot;account_id\&quot;: \&quot;%ACCOUNT_ID%\&quot;}\&quot;</code>.</p></blockquote><p>Before proceeding with the tutorial below, check that you have control of your lockup contract, by issuing the command</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near view </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> get_owner_account_id </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ near view meerkat.stakewars.testnet get_owner_account_id &#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">View call: meerkat.stakewars.testnet.get_owner_account_id()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;meerkat.testnet&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that this example us using <code>NEAR_ENV=testnet</code> with <code>$LOCKUP_ID</code> set to <code>meerkat.stakewars.testnet</code> and <code>ACCOUNT_ID</code> set to <code>meerkat.testnet</code>, which matches the returned result above.</p><p>You can stake with Lockup contracts in three steps:</p><ol><li>Set up the staking pool</li><li>Deposit and stake the tokens</li><li>Measure the rewards</li></ol><h3 class="anchor anchorWithStickyNavbar_31ik" id="a-set-the-staking-pool">a. Set the staking pool<a aria-hidden="true" class="hash-link" href="#a-set-the-staking-pool" title="Direct link to heading">â€‹</a></h3><p>Lockup contracts can stake <strong>to one staking pool at a time</strong>, so this parameter can be changed only while no funds are staked.</p><p>You can select the staking pool by calling the method <code>select_staking_pool</code> from the lockup contract:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> select_staking_pool </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;staking_pool_account_id&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$POOL_ID</span><span class="token string" style="color:#e3116c">&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If using a Ledger:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> select_staking_pool </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;staking_pool_account_id&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$POOL_ID</span><span class="token string" style="color:#e3116c">&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --useLedgerKey </span><span class="token variable" style="color:#36acaa">$HD_PATH</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Scheduling a call: meerkat.stakewars.testnet.select_staking_pool({&quot;staking_pool_account_id&quot;: &quot;zpool.pool.f863973.m0&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: HEATt32tHqWdjkZoSxLhd43CYVBCUp1cFHexgWBEeKJg, EUP7tncJfKDPpKYdunx2qySZ6JmV3injBigyFBiuD96J, 99hdXWmaTQE7gR5vucxMWFNMw7ZLtzJ6WNMSVJHPGJxh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Selecting staking pool @zpool.pool.f863973.m0. Going to check whitelist first.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction Id 4Z2t1SeN2rdbJcPvfVGScpwyuGGKobZjT3eqvDu28sBk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To see the transaction in the transaction explorer, please open this url in your browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://explorer.testnet.near.org/transactions/4Z2t1SeN2rdbJcPvfVGScpwyuGGKobZjT3eqvDu28sBk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>true</code> statement means that your call was successful, and the lockup contract accepted the <code>$POOL_ID</code> parameter.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="b-deposit-and-stake-the-tokens">b. Deposit and stake the tokens<a aria-hidden="true" class="hash-link" href="#b-deposit-and-stake-the-tokens" title="Direct link to heading">â€‹</a></h3><p>Lockup contracts can stake their balance, regardless of their vesting schedule. You can proceed in two steps:</p><ol><li>check the lockup balance</li><li>stake the balance</li><li>To know how many tokens you can stake, use the view method <code>get_balance</code>:</li></ol><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near view $LOCKUP_ID get_balance &#x27;&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ near view meerkat.stakewars.testnet get_balance &#x27;&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">View call: meerkat.stakewars.testnet.get_balance()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;100000499656128234500000000&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Where the resulting balance <!-- -->(<!-- -->in <a href="https://www.nist.gov/pml/weights-and-measures/metric-si-prefixes" target="_blank" rel="noopener noreferrer">yocto</a>NEAR<!-- -->)<!-- --> is <code>100000499656128234500000000</code> or 100 $NEAR.</p><blockquote><p><strong>heads up</strong>  </p><p> You have to leave 35 $NEAR in the lockup contract for the storage fees. If you have 100 tokens, you can stake up to 65 tokens. If you have 1000 tokens, you can stake up to 965 tokens.</p><p>You may want to <code>npm i -g near-units</code> to easily convert yoctoNEAR amounts to human-readable representations, and to go from human-typeable numbers to yoctoNEAR. Examples:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near-units -h </span><span class="token number" style="color:#36acaa">100000499656128234500000000</span><span class="token plain"> yN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">near-units </span><span class="token number" style="color:#36acaa">965</span><span class="token plain"> N</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>On Linux/macOS/Unix, you can also use this directly in the following commands:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> deposit_and_stake </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;amount&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">near-units 965N</span><span class="token variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --gas </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">near-units 200Tgas</span><span class="token variable" style="color:#36acaa">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div></blockquote><p>You may want to set your desired amount-to-stake to a variable:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">export AMOUNT=# your desired amount to stake</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>To stake the balance, use the call method <code>deposit_and_stake</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> deposit_and_stake </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;amount&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$AMOUNT</span><span class="token string" style="color:#e3116c">&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --gas </span><span class="token number" style="color:#36acaa">200000000000000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If using a Ledger:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> deposit_and_stake </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;amount&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$AMOUNT</span><span class="token string" style="color:#e3116c">&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --gas </span><span class="token number" style="color:#36acaa">200000000000000</span><span class="token plain"> --useLedgerKey </span><span class="token variable" style="color:#36acaa">$HD_PATH</span><span class="token plain"> </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><blockquote><p><strong>Heads up</strong>  </p><p> This sets the gas parameter to 200000000000000 <a href="https://docs.near.org/docs/concepts/gas" target="_blank" rel="noopener noreferrer">gas units</a>, or 200 Tgas (Teragas), as the near-cli default allocation of 30Tgas is too low.</p></blockquote><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Scheduling a call: meerkat.stakewars.testnet.deposit_and_stake({&quot;amount&quot;: &quot;65000000000000000000000000&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: BFJxgYMbPLpKy4jae3b5ZJfLuAmpcYCBG2oJniDgh1PA, 9sZSqdLvPXPzpRg9VLwaWjJaBUnXm42ntVCEK1UwmYTp, CMLdB4So6ZYPif8qq2s7zFvKw599HMBVcBfQg85AKNQm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Depositing and staking 65000000000000000000000000 to the staking pool @zpool.pool.f863973.m0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: 3VpzWTG9Y2nbZmuJhmsub9bRLnwHCFtnW5NQqcMBWawF, 4BrEKDPmz3mAhnq5tTFYRQp8y9uRxGFwYffJFkPMdQ5P, HJPqqJDTajFfeEA8vFXTLDpxh4PYZCMJ2YLKpWVtwSMF</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Epoch 105: Contract received total rewards of 20383576173536987339742291104 tokens. New total staked balance is 104251712242552700026473040909. Total number of shares 77295581098329153455984430997</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Total rewards fee is 1511304065231935217653387665 stake shares.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: @meerkat.stakewars.testnet deposited 65000000000000000000000000. New unstaked balance is 65000000000000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: @meerkat.stakewars.testnet staking 64999999999999999999999999. Received 48193095953206307331949682 new staking shares. Total 1 unstaked balance and 48193095953206307331949682 staking shares</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Contract total staked balance is 104316712242552700026473040909. Total number of shares 77343774194282359763316380679</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipt: FsJLXXEa8Jp8UNyiyG3XQhyHHSWzZ2bCjgWr8kPVjGmG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: The deposit and stake of 65000000000000000000000000 to @zpool.pool.f863973.m0 succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction Id AW9pFb5RjkCjsyu8ng56XVvckvd3drPBPtnqVo6bJhqh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To see the transaction in the transaction explorer, please open this url in your browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://explorer.testnet.near.org/transactions/AW9pFb5RjkCjsyu8ng56XVvckvd3drPBPtnqVo6bJhqh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>true</code> statement at the end means the transaction was successful.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="c-measure-the-rewards">c. Measure the rewards<a aria-hidden="true" class="hash-link" href="#c-measure-the-rewards" title="Direct link to heading">â€‹</a></h3><p>Since NEAR automatically re-stakes all staking pool rewards, you have to update your staked balance to know the amount of tokens you earned with your validator.</p><p>Use the call method <code>refresh_staking_pool_balance</code> to check your new balance:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> refresh_staking_pool_balance </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>If using a Ledger:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> refresh_staking_pool_balance </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --useLedgerKey </span><span class="token variable" style="color:#36acaa">$HD_PATH</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ near call $LOCKUP_ID refresh_staking_pool_balance &#x27;&#x27; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --accountId $ACCOUNT_ID | grep &quot;current total balance&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: The current total balance on the staking pool is 65000000000000000000000000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that in this example, the result is piped to <a href="https://www.tutorialspoint.com/unix_commands/grep.htm" target="_blank" rel="noopener noreferrer">grep</a> (<code>| grep &quot;current total balance&quot;</code>) to display only the relevant output.</p><p>Please refer to the <a href="https://github.com/near/core-contracts/tree/master/lockup" target="_blank" rel="noopener noreferrer">Lockup Contract readme</a> if you need to know how to withdraw the staking rewards to your main wallet.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="unstake-and-withdraw-your-lockup-tokens">Unstake and withdraw your lockup tokens<a aria-hidden="true" class="hash-link" href="#unstake-and-withdraw-your-lockup-tokens" title="Direct link to heading">â€‹</a></h2><p>NEAR Protocol automatically re-stakes all the rewards back to the staking pools, so your staked balance increases over time, accruing rewards.</p><p>Before starting, it&#x27;s highly recommended to read the <a href="/wiki/docs/Getting Started/near-token/lockups">Lockup contracts documentation</a> to understand which portion of the tokens is liquid, and which one is still <em>locked</em> even after the three epochs.</p><p>If you want to withdraw funds, you have to issue two separate commands:</p><ol><li>Manually unstake tokens from the staking pool, and wait three epochs</li><li>Manually withdraw tokens back to your main account</li></ol><p>Both these command require the amount in yoctoNEAR, which is the smallest unit of account for NEAR tokens. You can use the table below for the conversion, or install <a href="https://www.npmjs.com/package/near-units" target="_blank" rel="noopener noreferrer">near-units</a> (<code>npm i -g near-units</code>) and use commands like <code>near-units 1,000N</code>:</p><table><thead><tr><th align="left">NEAR</th><th align="left">YoctoNEAR</th><th align="left">YoctoNEAR</th></tr></thead><tbody><tr><td align="left"><code>1</code></td><td align="left"><code>1*10^24</code></td><td align="left"><code>1000000000000000000000000</code></td></tr><tr><td align="left"><code>10</code></td><td align="left"><code>1*10^25</code></td><td align="left"><code>10000000000000000000000000</code></td></tr><tr><td align="left"><code>100</code></td><td align="left"><code>1*10^26</code></td><td align="left"><code>100000000000000000000000000</code></td></tr><tr><td align="left"><code>1,000</code></td><td align="left"><code>1*10^27</code></td><td align="left"><code>1000000000000000000000000000</code></td></tr><tr><td align="left"><code>10,000</code></td><td align="left"><code>1*10^28</code></td><td align="left"><code>10000000000000000000000000000</code></td></tr></tbody></table><p>As an example, if you want to unstake <code>10</code> NEAR tokens from the staking pool, you have to call the method <code>unstake</code> with <code>10000000000000000000000000</code> <!-- -->(<code>1*10^24</code>, 10 power 24, or 10 with 24 zeros<!-- -->)<!-- --> as an argument.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="a-unstake-the-tokens">a. Unstake the tokens<a aria-hidden="true" class="hash-link" href="#a-unstake-the-tokens" title="Direct link to heading">â€‹</a></h3><p>Before unstaking any tokens, use the the view method <code>get_account</code> introduced above to know what is the available balance:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near view $POOL_ID get_account &#x27;{&quot;account_id&quot;: &quot;&#x27;$LOCKUP_ID&#x27;&quot;}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">$ near view zpool.pool.f863973.m0 get_account &#x27;{&quot;account_id&quot;: &quot;meerkat.stakewars.testnet&quot;}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">View call: zpool.pool.f863973.m0.get_account({&quot;account_id&quot;: &quot;meerkat.stakewars.testnet&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  account_id: &#x27;meerkat.stakewars.testnet&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  unstaked_balance: &#x27;5&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  staked_balance: &#x27;86236099167204810592552675&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  can_withdraw: false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The result of this method shows:</p><ul><li>An unstaked balance of <code>5</code> <em>yocto</em></li><li>A staked balance of <code>86236099167204810592552675</code> <em>yocto</em>, or <code>86.23</code> $NEAR</li><li><code>can_withdraw</code> is <code>false</code> <!-- -->(<!-- -->see below<!-- -->)</li></ul><blockquote><p><strong>Check your rewards</strong>  </p><p> From the examples above, the initial stake of 65 NEAR tokens increased to 86.23 tokens, with 21.23 tokens as a reward!</p></blockquote><p>You can unstake an amount of funds that is equal or lower than your <code>staked_balance</code>, by calling the metod <code>unstake</code>. You may first want to set the amount you want to unstake to a variable <code>AMOUNT</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">AMOUNT</span><span class="token operator" style="color:#393A34">=</span><span class="token comment" style="color:#999988;font-style:italic"># amount to unstake</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Check that it looks correct:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$AMOUNT</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And maybe also using <code>near-units</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near-units -h </span><span class="token variable" style="color:#36acaa">$AMOUNT</span><span class="token plain"> yN</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>And now unstake:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> unstake </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;amount&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$AMOUNT</span><span class="token string" style="color:#e3116c">&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --gas </span><span class="token number" style="color:#36acaa">200000000000000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Or with a Ledger:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> unstake </span><span class="token string" style="color:#e3116c">&#x27;{</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">  &quot;amount&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$AMOUNT</span><span class="token string" style="color:#e3116c">&#x27;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --gas </span><span class="token number" style="color:#36acaa">200000000000000</span><span class="token plain"> --useLedgerKey </span><span class="token variable" style="color:#36acaa">$HD_PATH</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Scheduling a call: meerkat.stakewars.testnet.unstake({&quot;amount&quot;: &quot;42000000000000000000000000&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for confirmation on Ledger...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using public key: ed25519:5JgsX9jWUTS5ttHeTjuDFgCmB5YX77f7GHxuQfaGVsyj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for confirmation on Ledger...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ledger app version: 1.1.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: D5fCCWa5b5N8X9VtxsbRvGhSSCQc56Jb312DEbG4YY8Z, 72rgHrMb1zkUU2RiEz2EMCAuMWFgRJTf8eovwAUkuo31, A2dvSgxpDXfNZUrDVdpewk1orVTVxCMiicjk7qyNq3dW</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Unstaking 42000000000000000000000000 from the staking pool @zpool.pool.f863973.m0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: 9MbLXn28nQyL6BopMEUggBD9NA1QfVio9VB3LTNJ6P5b, 5g7F6HehoGZ2DHS7w54xHAjAeHCsHaAsKpVed76MFYru, BKbtF77i1WEqpuFLtEjWerM2LVZW1md9ecQ5UcBpMNXj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Epoch 162: Contract received total rewards of 9488161121527521670023204339 tokens. New total staked balance is 142388816229749953331375665038. Total number of shares 79574075700231185032355056920</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Total rewards fee is 530246455678218748147822292 stake shares.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: @meerkat.stakewars.testnet unstaking 42000000000000000000000001. Spent 23471725293488513736732361 staking shares. Total 42000000000000000000000002 unstaked balance and 24721370659717793595217321 staking shares</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Contract total staked balance is 142346816229749953331375665038. Total number of shares 79550603974937696518618324559</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipt: 3DXSx8aMvhwtJUB6mhTueNbDiqz5wYu3xzzYkZrgjw1u</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Unstaking of 42000000000000000000000000 at @zpool.pool.f863973.m0 succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction Id 2rRpdN8AAoySfWsgE7BRtRfz7VFnyFzRhssfaL87rXGf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To see the transaction in the transaction explorer, please open this url in your browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://explorer.testnet.near.org/transactions/2rRpdN8AAoySfWsgE7BRtRfz7VFnyFzRhssfaL87rXGf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>true</code> statement at the end means the transaction was successful.</p><p><strong>Wait three epochs, or ~36 hours before using the withdraw command</strong></p><p>For security reasons, NEAR Protocol keeps your unstaked funds locked for three more epochs <!-- -->(<!-- -->~36 hours<!-- -->)<!-- -->. Use again the view method <code>get_account</code> to verify if <code>can_withdraw</code> is <code>true</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near view $POOL_ID get_account &#x27;{&quot;account_id&quot;: &quot;&#x27;$LOCKUP_ID&#x27;&quot;}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The result should be as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">View call: zpool.pool.f863973.m0.get_account({&quot;account_id&quot;: &quot;meerkat.stakewars.testnet&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  account_id: &#x27;meerkat.stakewars.testnet&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  unstaked_balance: &#x27;42000000000000000000000006&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  staked_balance: &#x27;44244760537191121230392104&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  can_withdraw: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Note that the variable <code>can_withdraw</code> is <code>true</code>. This means that the <code>unstaked_balance</code> of <code>42000000000000000000000000</code> yoctoNEAR <!-- -->(<!-- -->42 NEAR tokens<!-- -->)<!-- --> is now available for withdraw.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="b-withdraw-the-tokens">b. Withdraw the tokens<a aria-hidden="true" class="hash-link" href="#b-withdraw-the-tokens" title="Direct link to heading">â€‹</a></h3><p>Funds can be withdrawn after three epochs <!-- -->(<!-- -->~36 hours<!-- -->)<!-- --> from the <code>unstake</code> command. It is highly recommended to read the <a href="/wiki/docs/Getting Started/near-token/lockups">Lockup contracts documentation</a> to understand which portion of the unstaked tokens is available for transfers, and which is still vesting and unavailable <!-- -->(<!-- -->even after three epochs<!-- -->)<!-- -->.</p><p>Use the call method <code>withdraw_all_from_staking_pool</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> withdraw_all_from_staking_pool </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --gas </span><span class="token number" style="color:#36acaa">200000000000000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Or if using a Ledger:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> withdraw_all_from_staking_pool </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --gas </span><span class="token number" style="color:#36acaa">200000000000000</span><span class="token plain"> --useLedgerKey </span><span class="token variable" style="color:#36acaa">$HD_PATH</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like this one:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Scheduling a call: meerkat.stakewars.testnet.withdraw_all_from_staking_pool()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for confirmation on Ledger...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Using public key: ed25519:5JgsX9jWUTS5ttHeTjuDFgCmB5YX77f7GHxuQfaGVsyj</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Waiting for confirmation on Ledger...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Ledger app version: 1.1.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: 6dt3HNDrb7jM4F7cRtwgRSfRMWwFmE8BHeZSDghrpQtw, 7pNKTevct7Z4birAPec81LmnSpJSeJXbFq3cBdjFvsnM, A7yJXdaGcFyiBNQimFtHF479Jm6xiXHvfodTbtFf7Rww</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Going to query the unstaked balance at the staking pool @zpool.pool.f863973.m0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: 2ytgB57D6CJe3vkxdVTiVAytygpTteR4sDmpUNxo5Ltk, CZChcT1uDDxqojnZQq6r7zzx6FE3Z6E5fZ3F23Y1dnyM, GjrWhJgbCAAHUNyvw4QX5YKFpeUVNJ9GpuEdmUXFozeG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Withdrawing 42000000000000000000000006 from the staking pool @zpool.pool.f863973.m0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: 9nHoqnQygqKYyyR5KDofkYy5KiJxbu2eymoGUUc2tSR3, 5RvBSb4BuHxRhc5U6nLgsCjAvJ88hJ2jwkr1ramk37mE, 5PDN1EYXnCJrTSU7zzJtmAuj9vvGSVurh94nvfHDHXpa, GTTGm4sXcSWD2gnohMJzD7TQcQxuSe7AFABZKqxPLgau</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Epoch 168: Contract received total rewards of 514182787298700000000 tokens. New total staked balance is 142377784876419564057032272059. Total number of shares 79552334320822393318832070510</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: Total rewards fee is 28729510739826825657 stake shares.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: @meerkat.stakewars.testnet withdrawing 42000000000000000000000006. New unstaked balance is 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipt: rS5KjvzkbaxEH7aG8VXyd9EEEfY7PygdLzSZ3W9qf3w</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [meerkat.stakewars.testnet]: The withdrawal of 42000000000000000000000006 from @zpool.pool.f863973.m0 succeeded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction Id EjNpoU7BNfEQujckL8JiAP8kYDH1SMLw4wC32tL3uyaH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To see the transaction in the transaction explorer, please open this url in your browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://explorer.testnet.near.org/transactions/EjNpoU7BNfEQujckL8JiAP8kYDH1SMLw4wC32tL3uyaH</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">true</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>true</code> statement confirms the successful withdrawal.</p><p>By using again the view method:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near view </span><span class="token variable" style="color:#36acaa">$POOL_ID</span><span class="token plain"> get_account </span><span class="token string" style="color:#e3116c">&#x27;{&quot;account_id&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token string" style="color:#e3116c">&#x27;&quot;}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The result should be as follows:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">View call: zpool.pool.f863973.m0.get_account({&quot;account_id&quot;: &quot;meerkat.stakewars.testnet&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  account_id: &#x27;meerkat.stakewars.testnet&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  unstaked_balance: &#x27;0&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  staked_balance: &#x27;44244760947075774431066852&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  can_withdraw: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>At this point the <code>unstaked_balance</code> is <code>0</code>, and the funds are back in the lockup contract balance.</p><blockquote><p><strong>Heads up</strong>  </p><p> Lockup contracts allow you to transfer only the unlocked portion of your funds. In the example above, out of the 42 NEAR unstaked, only 21.23 can be transferred to another wallet or exchange.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_31ik" id="c-change-staking-pools">c. Change staking pools<a aria-hidden="true" class="hash-link" href="#c-change-staking-pools" title="Direct link to heading">â€‹</a></h3><p>To change from one staking pool to another, you must first withdraw all deposits in the currently selected staking pool. Then call <code>unselect_staking_pool</code> as follows <!-- -->(<a href="https://github.com/near/core-contracts/blob/215d4ed2edb563c47edd961555106b74275c4274/lockup/README.md" target="_blank" rel="noopener noreferrer">docs</a>)<!-- -->:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> unselect_staking_pool --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --gas </span><span class="token number" style="color:#36acaa">300000000000000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Or if using Ledger:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$LOCKUP_ID</span><span class="token plain"> unselect_staking_pool --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --useLedgerKey </span><span class="token variable" style="color:#36acaa">$HD_PATH</span><span class="token plain"> --gas </span><span class="token number" style="color:#36acaa">300000000000000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_31ik" id="staking-pool-delegation">Staking Pool Delegation<a aria-hidden="true" class="hash-link" href="#staking-pool-delegation" title="Direct link to heading">â€‹</a></h2><p>Any funds that are not stored inside lockup contracts can be directly delegated to a <a href="https://github.com/near/core-contracts/tree/master/staking-pool" target="_blank" rel="noopener noreferrer">staking pool</a> by using the call method <code>deposit_and_stake</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$POOL_ID</span><span class="token plain"> deposit_and_stake </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --amount </span><span class="token number" style="color:#36acaa">100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Or if using Ledger:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$POOL_ID</span><span class="token plain"> deposit_and_stake </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --useLedgerKey </span><span class="token variable" style="color:#36acaa">$HD_PATH</span><span class="token plain"> --amount </span><span class="token number" style="color:#36acaa">100</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Scheduling a call: valeraverim.pool.f863973.m0.deposit_and_stake() with attached 100 NEAR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Receipts: FEfNuuCSttu7m4dKQPUSgpSFJSB86i6T2sYJWSv7PHPJ, GPYhZsyUuJgvr7gefxac4566DVQcyGs4wSFeydkmRX7D, 8hfcJuwsstnFQ1cgU5iUigvfrq1JcbaKURvKf5shaB4g</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [valeraverim.pool.f863973.m0]: Epoch 106: Contract received total rewards of 545371217890000000000 tokens. New total staked balance is 75030000959768421358700000000. Total number of shares 75029067713856889417103116457</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [valeraverim.pool.f863973.m0]: Total rewards fee is 54536443439735902364 stake shares.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [valeraverim.pool.f863973.m0]: @meerkat.testnet deposited 100000000000000000000000000. New unstaked balance is 100000000000000000000000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [valeraverim.pool.f863973.m0]: @meerkat.testnet staking 99999999999999999999999999. Received 99998756169666008195607157 new staking shares. Total 1 unstaked balance and 99998756169666008195607157 staking shares</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Log [valeraverim.pool.f863973.m0]: Contract total staked balance is 75130000959768421358700000000. Total number of shares 75129066470026555425298723614</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction Id FDtzMmusJgFbryeVrdQyNvp6XU2xr11tecgqnnSsvyxv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To see the transaction in the transaction explorer, please open this url in your browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://explorer.testnet.near.org/transactions/FDtzMmusJgFbryeVrdQyNvp6XU2xr11tecgqnnSsvyxv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The empty string at the end, <code>&#x27;&#x27;</code>, means the call was successful.</p><p>If you want to check your staking rewards, use the view method <code>get_account</code>:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near view </span><span class="token variable" style="color:#36acaa">$POOL_ID</span><span class="token plain"> get_account </span><span class="token string" style="color:#e3116c">&#x27;{&quot;account_id&quot;: &quot;&#x27;</span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token string" style="color:#e3116c">&#x27;&quot;}&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">View call: valeraverim.pool.f863973.m0.get_account({&quot;account_id&quot;: &quot;meerkat.testnet&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  account_id: &#x27;meerkat.testnet&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  unstaked_balance: &#x27;1&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  staked_balance: &#x27;100663740438210643632989745&#x27;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  can_withdraw: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The staked balance in this example is <code>100663740438210643632989745</code>, or <code>100.66</code> $NEAR (reminder: you can easily convert these using <code>near-units -h 100663740438210643632989745yN</code>).</p><p>A pool&#x27;s rewards only compound if it has been &quot;pinged&quot;, which means either having a direct action performed on it <!-- -->(<!-- -->like someone delegating or undelegating<!-- -->)<!-- --> or if the <code>ping</code> method is called on it once within a particular epoch. This is important to do if you run a pool and want your delegators to see updated reward balances.</p><p>Use the call method <code>ping</code> to re-calculate the rewards up to the previous epoch:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$POOL_ID</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Or if using a Ledger:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly bash"><pre tabindex="0" class="prism-code language-bash codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">near call </span><span class="token variable" style="color:#36acaa">$POOL_ID</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ping</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{}&#x27;</span><span class="token plain"> --accountId </span><span class="token variable" style="color:#36acaa">$ACCOUNT_ID</span><span class="token plain"> --useLedgerKey </span><span class="token variable" style="color:#36acaa">$HD_PATH</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>You should expect a result like:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly text"><pre tabindex="0" class="prism-code language-text codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">Scheduling a call: valeraverim.pool.f863973.m0.ping({})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Transaction Id 4mTrz1hDBMTWZx251tX4M5CAo5j7LaxLiPtQrDvQgcZ9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To see the transaction in the transaction explorer, please open this url in your browser</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">https://explorer.testnet.near.org/transactions/4mTrz1hDBMTWZx251tX4M5CAo5j7LaxLiPtQrDvQgcZ9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27;&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>The <code>&#x27;&#x27;</code> result means that your call was successful, and the <code>get_account</code> view method will provide updated results.</p><p>Note that you can ping any pool, not just one you own.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="additional-links">Additional links<a aria-hidden="true" class="hash-link" href="#additional-links" title="Direct link to heading">â€‹</a></h2><ul><li><a href="/wiki/docs/Getting Started/near-token/lockups">Lockup contracts explained</a></li><li><a href="https://github.com/near/core-contracts" target="_blank" rel="noopener noreferrer">NEAR Core Contracts on Github</a></li><li><a href="https://explorer.near.org" target="_blank" rel="noopener noreferrer">NEAR block explorer</a></li><li><a href="https://github.com/near/near-cli" target="_blank" rel="noopener noreferrer">near-cli on Github</a></li></ul><h2 class="anchor anchorWithStickyNavbar_31ik" id="fun-facts">Fun Facts<a aria-hidden="true" class="hash-link" href="#fun-facts" title="Direct link to heading">â€‹</a></h2><ol><li><p><code>ping</code>ing a pool technically removes 2 epochs of future compounding but it&#x27;s an extremely small amount -- without considering compounding effect of epochs with 9 hour epochs, the reward per epoch is 5% / <!-- -->(<!-- -->365 <!-- -->*<!-- --> 24 / 9<!-- -->)<!-- --> + 1 or 1.00005136986</p><p>It means this reward on top of reward is what youâ€™re losing, so that&#x27;s about 1.00000000264 or 0.000000264%... meaning for 10M stake itâ€™s 0.02638862826 NEAR per epoch.</p></li></ol><blockquote><p>Got a question? </p><p>Ask it on <a href="https://stackoverflow.com/questions/tagged/nearprotocol" target="_blank" rel="noopener noreferrer">StackOverflow!</a></p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/near/wiki/edit/main/wiki/docs/Getting Started/near-token/token-delegation.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/wiki/docs/Getting Started/near-token/token-custody"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Token Custody</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/wiki/docs/Getting Started/near-token/whats-an-nft"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">What&#x27;s an NFT?<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a><ul><li><a href="#viewing-and-choosing-validators" class="table-of-contents__link toc-highlight">Viewing and Choosing Validators</a></li></ul></li><li><a href="#gui-based-delegation-via-a-website-or-app" class="table-of-contents__link toc-highlight">GUI-based delegation (via a website or app)</a></li><li><a href="#cli-based-delegation" class="table-of-contents__link toc-highlight">CLI-based delegation</a></li><li><a href="#1-lockup-contracts-delegation" class="table-of-contents__link toc-highlight">1. Lockup Contracts Delegation</a><ul><li><a href="#a-set-the-staking-pool" class="table-of-contents__link toc-highlight">a. Set the staking pool</a></li><li><a href="#b-deposit-and-stake-the-tokens" class="table-of-contents__link toc-highlight">b. Deposit and stake the tokens</a></li><li><a href="#c-measure-the-rewards" class="table-of-contents__link toc-highlight">c. Measure the rewards</a></li></ul></li><li><a href="#unstake-and-withdraw-your-lockup-tokens" class="table-of-contents__link toc-highlight">Unstake and withdraw your lockup tokens</a><ul><li><a href="#a-unstake-the-tokens" class="table-of-contents__link toc-highlight">a. Unstake the tokens</a></li><li><a href="#b-withdraw-the-tokens" class="table-of-contents__link toc-highlight">b. Withdraw the tokens</a></li><li><a href="#c-change-staking-pools" class="table-of-contents__link toc-highlight">c. Change staking pools</a></li></ul></li><li><a href="#staking-pool-delegation" class="table-of-contents__link toc-highlight">Staking Pool Delegation</a></li><li><a href="#additional-links" class="table-of-contents__link toc-highlight">Additional links</a></li><li><a href="#fun-facts" class="table-of-contents__link toc-highlight">Fun Facts</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a href="https://near.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Website</a></li><li class="footer__item"><a href="https://docs.near.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Docs</a></li><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/nearprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://near.chat" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/NEARprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://gov.near.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://near.org/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/near" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://near.university" target="_blank" rel="noopener noreferrer" class="footer__link-item">Education</a></li></ul></div></div><div class="footer__bottom text--center"></div></div></footer></div>
<script src="/wiki/assets/js/runtime~main.ce76e5ac.js"></script>
<script src="/wiki/assets/js/main.29d6ec1b.js"></script>
</body>
</html>